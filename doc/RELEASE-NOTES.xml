<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE readme SYSTEM "readme.dtd" [

<!ENTITY % common SYSTEM "common.xml">
%common;

<!-- Special HTML config: -->
<!ENTITY % readme:html:up '<a href="../..">up</a>'>

<!ENTITY % config SYSTEM "config.xml">
%config;

]>

<readme title="Release Notes for PXP (Last updated:  20-Jul-2001)">
  <sect1>
    <title>Linker problems</title>

    <sect2>
      <title>Assert_failure ("pxp_lexers.ml", 1573, 1585)</title>

      <p>This issue applies to: <em>PXP 1.1</em></p>

      <p><em>Problem description:</em>
<code>
"We just install the pxp parser and have trouble in using it. 
We always obtained an exception that we can not suppress. 
Do you know if it's a problem of setting configuration options. 
 
#  let d = parse_dtd_entity default_config (from_file "DAG.xml");; 
                                              ^^^^^^^^^^^? 
Uncaught exception: Assert_failure ("pxp_lexers.ml", 1573, 1585)."
</code>
</p>

      <p><em>Explanation:</em> You need to link a lexer to the executable. (Ok,
the error message could be better; an Assert_failure is not very explanative.)
Lexers are dynamically registered at runtime in the module Pxp_lexers, so
you can link an executable that does not contain a lexer without producing a
linker error.</p>

      <p>Example how to link correctly:</p>
      <ul>
	<li><p>Direct linking without findlib:
<code>
ocamlc -o my_exec ... pxp_engine.cma pxp_lex_iso88591.cma
          pxp_lex_link_iso88591.cmo
</code>

Don't forget to add the .cmo file! It contains the registering code that plugs
the lexers from pxp_lex_iso88591.cma into the registry. It _must_ be a .cmo
file, otherwise the initialization call would be "garbage-collected" at
link-time. (.cmx file if ocamlopt is used.)
</p>
	</li>
	<li><p>Linking with findlib:
<code>
ocamlfind ocamlc -o my_exec ... -package "pxp_engine,pxp_lex_iso88591" -linkpkg
</code>
</p>
	</li>
      </ul>

      <p>For the other lexers, the linker calls are similar.</p>

      <p>The following combinations of lexers are reasonable:</p>

      <ul>
	<li><p>pxp_lex_iso88591 alone</p>
	</li>
	<li><p>pxp_lex_utf8 alone</p>
	</li>
	<li><p>pxp_lex_iso88591 + pxp_lex_utf8</p>
	</li>
	<li><p>pxp_wlex alone</p>
	</li>
      </ul>

      <p>It is not reasonable not to have a lexer at all, even if PXP is only
used to represent XML trees internally, and not as parser. There must be a lexer
for the character set that is used for the internal representation of
strings. For example, if config.encoding = `Enc_utf8 (see module Pxp_yacc for
the config record), there must be a lexer for UTF-8 (i.e. pxp_lex_utf8 or
pxp_wlex).</p>
    </sect2>
  </sect1>
</readme>





      
